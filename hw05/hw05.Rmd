---
title: "hw05"
author: "Victoria Michalowski"
date: "October 20, 2017"
output: html_document
---
I chose to explore GAPMINDER data for this homework.

```{rsetup, echo=TRUE, message=F, warning=F}
knitr::opts_chunk$set(fig.width=5, fig.height=3, fig.align="center")

suppressPackageStartupMessages(library(gapminder))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(forcats))
```


FACTOR MANAGEMENT

1. Drop Oceania. Filter the Gapminder data to remove observations associated with the continent of Oceania. 
Additionally, remove unused factor levels. 
Provide concrete information on the data before and after removing these rows and Oceania; address the number of rows and the levels of the affected factors.

```{r}
#the original data
nrow(gapminder) #n rows for Oceania = 24; total rows = 1704
nlevels(gapminder$continent)
fct_count(gapminder$continent)

xOcn_gapminder <- gapminder %>% #drop Oceania
  filter(continent!="Oceania") #keep all continents excpet for Oceania

xOcn_gapminder1 <- xOcn_gapminder %>% #remove unused factor levels
  droplevels()

#the data after removing unused factor levels and Oceania
nrow(xOcn_gapminder1) #1704 - 24 = 1680 = n total rows for current data
nlevels(xOcn_gapminder1$continent)
fct_count(xOcn_gapminder1$continent)
```


2. Reorder the levels of country or continent. 
Use the forcats package to change the order of the factor levels, based on a principled summary of one of the quantitative variables. 
Consider experimenting with a summary statistic beyond the most basic choice of the median.

```{r}
xOcn_gapminder1$continent %>% 
  levels() #default order is alphabetical, which is arbitrary

#order according to mean life expectancy (instead of median)
xOcn_gapminder2 <- fct_reorder(xOcn_gapminder1$continent, xOcn_gapminder1$lifeExp, mean) %>%
  levels()
head(xOcn_gapminder2)

#or backwards (from highest mean lifeExp to lowest)
xOcn_gapminder3 <- fct_reorder(xOcn_gapminder1$continent, xOcn_gapminder1$lifeExp, .desc=TRUE)

levels(xOcn_gapminder3)
head(xOcn_gapminder3)
summary(xOcn_gapminder3)
```

FILE I/O

Experiment with one or more of write_csv()/read_csv() (and/or TSV friends), saveRDS()/readRDS(),  dput()/dget(). 
Create something new, probably by filtering or grouped-summarization of Singer or Gapminder. I highly recommend you fiddle with the factor levels, i.e. make them non-alphabetical (see previous section). Explore whether this survives the round trip of writing to file then reading back in.

```{r}
#1. Locate the gapminder data
(gap_tsv <- system.file("gapminder.tsv", package = "gapminder"))

#2. Bring rectangular data in
gapminder <- read_tsv(gap_tsv)
str(gapminder, give.attr=FALSE)

#3. Compute something worthy of export
xOcn_gapminder3 #I'll use the reordered data generated in the last section

#3. Write rectangular data out
write_csv(xOcn_gapminder3, "xOcn_gapminder3.csv")
```

vISUALIZATION DESIGN

Remake at least one figure or create a new one, in light of something you learned in the recent class meetings about visualization design and color. Maybe juxtapose your first attempt and what you obtained after some time spent working on it. Reflect on the differences. If using Gapminder, you can use the country or continent color scheme that ships with Gapminder.

Characterize the (derived) data before and after your factor re-leveling.

a. Explore the effects of arrange(). Does merely arranging the data have any effect on, say, a figure?
b. Explore the effects of reordering a factor and factor reordering coupled with arrange(). Especially, what effect does this have on a figure?

WRITING FIGURES TO FILE

Use ggsave() to explicitly save a plot to file. Then use ![Alt text](/path/to/img.png) to load and embed it in your report. You can play around with various options, such as:
Arguments of ggsave(), such as width, height, resolution or text scaling.
Various graphics devices, e.g. a vector vs. raster format.
Explicit provision of the plot object p via ggsave(..., plot = p). Show a situation in which this actually matters.

CLEAN UP YOUR REPO!
You have 6 weeks of R Markdown and GitHub experience now. You've reviewed 4 peer assignments. Surely there are aspects of your current repo organization that could be better. Deal with that. 
Ideas:
A nice Table of Contents in top-level README that links to individual pieces of work.
Good for future: hw03 dplyr verbs
Bummer in the future: hw03
Include a slug with content info!
Remove all downstream stuff, e.g. figures, html, etc. and re-render everything. It will be nice to not have weird, vestigial files lying around to puzzle you in future.
Anything that's Rmd but that could be md? Convert it.

BUT I WANT TO DO MORE!
Make a deeper exploration of the forcats packages, i.e. try more of the factor level reordering functions.
When you get tired, if you still have time on your hand, try to make this process of geolocalization more streamlined: you may want to try and use the separate function from tidyr.
Gapminder version: Pick a handful of countries, each of which you can associate with a stereotypical food (or any other non-controversial thing . sport? hobby? type of music, art or dance? animal? landscape feature?). Create an excerpt of the Gapminder data, filtered to just these countries. Create a new factor - you pick the name! - by mapping the existing country factor levels to the new levels.
Examples: Italy -> wine, Germany -> beer, Japan -> sake. (Austria, Germany) -> German, (Mexico, Spain) -> Spanish, (Portugal, Brazil) -> Portuguese. Let your creativity flourish.

PROCESS REPORT




